%% Import data from spreadsheet
% Script for importing data from the following spreadsheet:
%
%    Workbook: C:\Users\Allu\Desktop\Töissä\Masters Thesis\Data\NaStA XRF_Measurements Samples from SPb and old Quarries_2021\NaStA Pakkala Hämeenkylä XRF_Mittaukset 2021_11_5 chemistry-ExportData.xls
%    Worksheet: NaStA_XRF_Mittaukset_Hämeenkylä
%
% Auto-generated by MATLAB on 11-Feb-2022 15:42:54

%% Set up the Import Options and import the data
opts = spreadsheetImportOptions("NumVariables", 217);

% Specify sheet and range
opts.Sheet = "NaStA_XRF_Mittaukset_Hämeenkylä";
opts.DataRange = "A2:HI82";

% Specify column names and types
opts.VariableNames = ["Var1", "Var2", "Var3", "Var4", "SampleID", "Var6", "Var7", "Var8", "Var9", "Var10", "MgConcentration", "MgError1s", "Var13", "Var14", "Var15", "AlConcentration", "AlError1s", "Var18", "Var19", "Var20", "SiConcentration", "SiError1s", "Var23", "Var24", "Var25", "PConcentration", "PError1s", "Var28", "Var29", "Var30", "SConcentration", "SError1s", "Var33", "Var34", "Var35", "KConcentration", "KError1s", "Var38", "Var39", "Var40", "CaConcentration", "CaError1s", "Var43", "Var44", "Var45", "TiConcentration", "TiError1s", "Var48", "Var49", "Var50", "VConcentration", "VError1s", "Var53", "Var54", "Var55", "CrConcentration", "CrError1s", "Var58", "Var59", "Var60", "MnConcentration", "MnError1s", "Var63", "Var64", "Var65", "FeConcentration", "FeError1s", "Var68", "Var69", "Var70", "CoConcentration", "CoError1s", "Var73", "Var74", "Var75", "NiConcentration", "NiError1s", "Var78", "Var79", "Var80", "CuConcentration", "CuError1s", "Var83", "Var84", "Var85", "ZnConcentration", "ZnError1s", "Var88", "Var89", "Var90", "AsConcentration", "AsError1s", "Var93", "Var94", "Var95", "SeConcentration", "SeError1s", "Var98", "Var99", "Var100", "RbConcentration", "RbError1s", "Var103", "Var104", "Var105", "SrConcentration", "SrError1s", "Var108", "Var109", "Var110", "YConcentration", "YError1s", "Var113", "Var114", "Var115", "ZrConcentration", "ZrError1s", "Var118", "Var119", "Var120", "NbConcentration", "NbError1s", "Var123", "Var124", "Var125", "MoConcentration", "MoError1s", "Var128", "Var129", "Var130", "AgConcentration", "AgError1s", "Var133", "Var134", "Var135", "CdConcentration", "CdError1s", "Var138", "Var139", "Var140", "SnConcentration", "SnError1s", "Var143", "Var144", "Var145", "SbConcentration", "SbError1s", "Var148", "Var149", "Var150", "BaConcentration", "BaError1s", "Var153", "Var154", "Var155", "LaConcentration", "LaError1s", "Var158", "Var159", "Var160", "CeConcentration", "CeError1s", "Var163", "Var164", "Var165", "PrConcentration", "PrError1s", "Var168", "Var169", "Var170", "NdConcentration", "NdError1s", "Var173", "Var174", "Var175", "TaConcentration", "TaError1s", "Var178", "Var179", "Var180", "WConcentration", "WError1s", "Var183", "Var184", "Var185", "AuConcentration", "AuError1s", "Var188", "Var189", "Var190", "HgConcentration", "HgError1s", "Var193", "Var194", "Var195", "PbConcentration", "PbError1s", "Var198", "Var199", "Var200", "BiConcentration", "BiError1s", "Var203", "Var204", "Var205", "ThConcentration", "ThError1s", "Var208", "Var209", "Var210", "UConcentration", "UError1s", "Var213", "Var214", "Var215", "LEConcentration", "LEError1s"];
opts.SelectedVariableNames = ["SampleID", "MgConcentration", "MgError1s", "AlConcentration", "AlError1s", "SiConcentration", "SiError1s", "PConcentration", "PError1s", "SConcentration", "SError1s", "KConcentration", "KError1s", "CaConcentration", "CaError1s", "TiConcentration", "TiError1s", "VConcentration", "VError1s", "CrConcentration", "CrError1s", "MnConcentration", "MnError1s", "FeConcentration", "FeError1s", "CoConcentration", "CoError1s", "NiConcentration", "NiError1s", "CuConcentration", "CuError1s", "ZnConcentration", "ZnError1s", "AsConcentration", "AsError1s", "SeConcentration", "SeError1s", "RbConcentration", "RbError1s", "SrConcentration", "SrError1s", "YConcentration", "YError1s", "ZrConcentration", "ZrError1s", "NbConcentration", "NbError1s", "MoConcentration", "MoError1s", "AgConcentration", "AgError1s", "CdConcentration", "CdError1s", "SnConcentration", "SnError1s", "SbConcentration", "SbError1s", "BaConcentration", "BaError1s", "LaConcentration", "LaError1s", "CeConcentration", "CeError1s", "PrConcentration", "PrError1s", "NdConcentration", "NdError1s", "TaConcentration", "TaError1s", "WConcentration", "WError1s", "AuConcentration", "AuError1s", "HgConcentration", "HgError1s", "PbConcentration", "PbError1s", "BiConcentration", "BiError1s", "ThConcentration", "ThError1s", "UConcentration", "UError1s", "LEConcentration", "LEError1s"];
opts.VariableTypes = ["char", "char", "char", "char", "string", "char", "char", "char", "char", "char", "categorical", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "double", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "double", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "double", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "double", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "categorical", "double", "char", "char", "char", "double", "double"];

% Replace cats with double
cat_idx = contains(opts.VariableTypes,'categorical');
opts.VariableTypes(cat_idx) = {'double'};

% Specify variable properties
opts = setvaropts(opts, ["Var1", "Var2", "Var3", "Var4", "SampleID", "Var6", "Var7", "Var8", "Var9", "Var10", "Var13", "Var14", "Var15", "Var18", "Var19", "Var20", "Var23", "Var24", "Var25", "Var28", "Var29", "Var30", "Var33", "Var34", "Var35", "Var38", "Var39", "Var40", "Var43", "Var44", "Var45", "Var48", "Var49", "Var50", "Var53", "Var54", "Var55", "Var58", "Var59", "Var60", "Var63", "Var64", "Var65", "Var68", "Var69", "Var70", "Var73", "Var74", "Var75", "Var78", "Var79", "Var80", "Var83", "Var84", "Var85", "Var88", "Var89", "Var90", "Var93", "Var94", "Var95", "Var98", "Var99", "Var100", "Var103", "Var104", "Var105", "Var108", "Var109", "Var110", "Var113", "Var114", "Var115", "Var118", "Var119", "Var120", "Var123", "Var124", "Var125", "Var128", "Var129", "Var130", "Var133", "Var134", "Var135", "Var138", "Var139", "Var140", "Var143", "Var144", "Var145", "Var148", "Var149", "Var150", "Var153", "Var154", "Var155", "Var158", "Var159", "Var160", "Var163", "Var164", "Var165", "Var168", "Var169", "Var170", "Var173", "Var174", "Var175", "Var178", "Var179", "Var180", "Var183", "Var184", "Var185", "Var188", "Var189", "Var190", "Var193", "Var194", "Var195", "Var198", "Var199", "Var200", "Var203", "Var204", "Var205", "Var208", "Var209", "Var210", "Var213", "Var214", "Var215"], "WhitespaceRule", "preserve");
opts = setvaropts(opts, ["Var1", "Var2", "Var3", "Var4", "SampleID", "Var6", "Var7", "Var8", "Var9", "Var10", "MgConcentration", "Var13", "Var14", "Var15", "Var18", "Var19", "Var20", "Var23", "Var24", "Var25", "Var28", "Var29", "Var30", "Var33", "Var34", "Var35", "Var38", "Var39", "Var40", "Var43", "Var44", "Var45", "Var48", "Var49", "Var50", "Var53", "Var54", "Var55", "CrConcentration", "Var58", "Var59", "Var60", "Var63", "Var64", "Var65", "Var68", "Var69", "Var70", "CoConcentration", "Var73", "Var74", "Var75", "NiConcentration", "Var78", "Var79", "Var80", "CuConcentration", "Var83", "Var84", "Var85", "Var88", "Var89", "Var90", "AsConcentration", "Var93", "Var94", "Var95", "SeConcentration", "Var98", "Var99", "Var100", "Var103", "Var104", "Var105", "Var108", "Var109", "Var110", "Var113", "Var114", "Var115", "Var118", "Var119", "Var120", "Var123", "Var124", "Var125", "Var128", "Var129", "Var130", "AgConcentration", "Var133", "Var134", "Var135", "CdConcentration", "Var138", "Var139", "Var140", "SnConcentration", "Var143", "Var144", "Var145", "SbConcentration", "Var148", "Var149", "Var150", "Var153", "Var154", "Var155", "LaConcentration", "Var158", "Var159", "Var160", "CeConcentration", "Var163", "Var164", "Var165", "PrConcentration", "Var168", "Var169", "Var170", "NdConcentration", "Var173", "Var174", "Var175", "TaConcentration", "Var178", "Var179", "Var180", "WConcentration", "Var183", "Var184", "Var185", "AuConcentration", "Var188", "Var189", "Var190", "HgConcentration", "Var193", "Var194", "Var195", "Var198", "Var199", "Var200", "BiConcentration", "Var203", "Var204", "Var205", "ThConcentration", "Var208", "Var209", "Var210", "UConcentration", "Var213", "Var214", "Var215"], "EmptyFieldRule", "auto");

% Import the data
Hameenkyla = readtable("C:\Users\Allu\Desktop\Töissä\Masters Thesis\Data\XRF\NaStA Pakkala Hämeenkylä XRF_Mittaukset 2021_11_5 chemistry-ExportData.xls", opts, "UseExcel", false);

% Error idx from variables
Errors_idx = contains(opts.SelectedVariableNames,'Error');
Errors_idx(1) = '';
% REE index
REE = contains(Hameenkyla.SampleID,'REE'); 
%% REE Data
% REE elements: Ba, La, Ce, Pr, Nd, Ta, 
% Data with REE
Hameenkyla_REE = Hameenkyla(REE,:);
% Get object/sample names
Hameenkyla_REE_obj = Hameenkyla_REE.SampleID;
% Fetch only the numbers of the samples
[~,remain] = strtok(Hameenkyla_REE_obj,{'1','2','3','4'});
[token1,remain1] = strtok(remain,'_');
[~,remain2] = strtok(remain,{'1','2','3','4','5','6','7','8','9'});
% Write objects as hn_ree_<square>_<number>
hk_ree_obj = 'hk_ree_'+token1+'_'+remain2;

% Table to matrix
hk_ree_data = Hameenkyla_REE(:,2:end).Variables;
% Remove errors
hk_ree_data(:,Errors_idx) = '';

hk_ree_var = Hameenkyla_REE.Properties.VariableNames(2:end);
% Remove errors
hk_ree_var(Errors_idx) = '';
% Erase "Concentration" from variable names
hk_ree_var = erase(hk_ree_var,"Concentration");
%% Data without REE
% Data without REE
Hameenkyla_ = Hameenkyla(~REE,:);
Hameenkyla_(1,:) = [];
% Get object/sample names
Hameenkyla_obj = Hameenkyla_.SampleID;
% Fetch only the numbers of the samples
[~,remain] = strtok(Hameenkyla_REE_obj,{'1','2','3','4'});
[token1,remain1] = strtok(remain,'_');
[~,remain2] = strtok(remain,{'1','2','3','4','5','6','7','8','9'});
% Write objects as hn_ree_<square>_<number>
hk_obj = 'hk_'+token1+'_'+remain2;

% Table to matrix
hk_data = Hameenkyla_(:,2:end).Variables;
% Remove errors
hk_data(:,Errors_idx) = '';

hk_var = Hameenkyla_.Properties.VariableNames(2:end);
% Remove errors
hk_var(Errors_idx) = '';
% Erase "Concentration" from variable names
hk_var = erase(hk_var,"Concentration");

%% Clear temporary variables
clear opts